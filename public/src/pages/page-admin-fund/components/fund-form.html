<link rel="import" href="../../components/format-number-behavior.html">
<link rel="import" href="./../../components/validateFormBehaviors.html">

<dom-module id="fund-form">
    <template>
        <style is="custom-style" include="page-style flex-style">
            paper-input,
            vaadin-date-picker,
            gl-combo-box {
                margin-top: 15px;
            }
            .label_condition {
                font-weight: bold;
                text-align: right;
                margin-top: 35px;
                font-size: 20px;
            }
            .btn-bottom {
                margin: 30px;
            }
            .container {
                padding: 20px;
            }
            paper-material {
                background-color: var(--gl-white-color);
            }
            paper-checkbox {
                font-family: 'CSChatThaiUI', sans-serif;
                -webkit-font-smoothing: antialiased;
            }
            paper-input,paper-textarea,paper-button,vaadin-combo-box{
                --paper-input-container-label:{
                    font-family: 'CSChatThaiUI', sans-serif;
                    -webkit-font-smoothing: antialiased;
                }
                --paper-input-container-label-floating:{
                    font-size: 18px;
                }
                --paper-input-container-input:{
                     font-family: 'CSChatThaiUI', sans-serif;
                    -webkit-font-smoothing: antialiased;
                }
                --paper-input-container-disabled:{
                    opacity:1;
                }
                --paper-input-container-underline-disabled:{
                    border: 0px solid white;
                }
            }
        </style>
        <div class="container">
            <paper-material elevation="1">
                <div class="container flex-equal-justified">
                    <div></div>
                    <div></div>
                    <div>
                        <paper-icon-button icon="create" on-tap="openEditForm"></paper-icon-button>
                    </div>
                </div>
                <gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,2]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-textarea required  style="margin-top:15px;" id="form" disabled="{{editForm}}" label="ชื่อ" value="{{data.rvd_name}}"></paper-textarea>
                    </gl-grid-col>
                    <div style="margin: 10px;"></div>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input required  id="form" disabled="{{editForm}}" label="CODE" value="{{data.rvd_code}}"></paper-input>
                    </gl-grid-col>
                </gl-grid-row>
                <!--<gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input id="form" disabled="{{editForm}}" label="CODE" value="{{data.rvd_code}}" placeholder="กรุณากรอก CODE"></paper-input>
                    </gl-grid-col>
                </gl-grid-row>-->
                <!-- // -->
                <gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,2]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input required  id="form" disabled="{{editForm}}" label="จำนวนสมาชิก" value="{{data.count_emp}}" placeholder="จำนวนสมาชิก" allowed-pattern="[0-9]"></paper-input>
                    </gl-grid-col>
                    <div style="margin: 10px;"></div>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input required  id="form" disabled="{{editForm}}" label="มูลค่าต่อหน่อย" value="{{data.unit_value}}" placeholder="มูลค่าต่อหน่อย" allowed-pattern="[0-9,.]"></paper-input>
                    </gl-grid-col>
                </gl-grid-row>
                <!--<gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input id="form" disabled="{{editForm}}" label="มูลค่าต่อหน่อย" value="{{data.unit_value}}" placeholder="มูลค่าต่อหน่อย"></paper-input>
                    </gl-grid-col>
                </gl-grid-row>-->
                <gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,2]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input required  id="form" disabled="{{editForm}}" label="ผลตอบแทน" value="{{data.reward}}" placeholder="ผลตอบแทน" allowed-pattern="[0-9,.]"></paper-input>
                    </gl-grid-col>
                    <div style="margin: 10px;"></div>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input required  id="form" disabled="{{editForm}}" label="มูลค่าทรัพสิน" value="{{data.property_value}}" placeholder="มูลค่าทรัพสิน" allowed-pattern="[0-9,.]"></paper-input>
                    </gl-grid-col>
                </gl-grid-row>
                <!--<gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-input id="form" disabled="{{editForm}}" label="มูลค่าทรัพสิน" value="{{data.property_value}}" placeholder="มูลค่าทรัพสิน"></paper-input>
                    </gl-grid-col>
                </gl-grid-row>-->
                <!-- /// -->
                <gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,2]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <vaadin-combo-box required  style="margin-top: 15px;" id="form" label="สถานะ" disabled="{{editForm}}" items="[[statusType]]"
                            item-label-path="label" item-value-path="value" value="{{data.status}}"></vaadin-combo-box>
                    </gl-grid-col>
                    <div style="margin: 10px;"></div>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <paper-textarea style="margin-top:15px;" disabled="{{editForm}}" label="รายละเอียด" value="{{data.description}}"></paper-textarea>
                    </gl-grid-col>
                </gl-grid-row>
                <!--<gl-grid-row width="{{getWidth}}">
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]"></gl-grid-col>
                    <gl-grid-col width="[[getWidth]]" grid="[[300,12],[500,4]]">
                        <vaadin-combo-box id="form" label="สถานะ" disabled="{{editForm}}" items="[[statusType]]" placeholder="กรุณาระบุสถานะ" always-float-label
                            item-label-path="label" item-value-path="value" value="{{data.status}}"></vaadin-combo-box>
                    </gl-grid-col>
                </gl-grid-row>-->

                <div class="horizontal end-justified layout btn-bottom">
                    <paper-button raised hidden="{{editForm}}" class="gl-btn-danger" on-tap="cancel">ยกเลิก</paper-button>
                    <paper-button raised hidden="{{editForm}}" class="gl-btn-success" on-tap="getForm">บันทึก</paper-button>
                </div>
            </paper-material>
        </div>
    </template>
    <script>
        Polymer({
            is: 'fund-form',
            behaviors: [ReduxBehavior, FormatNumberBehavior,ValidateFormBehavior],
            properties: {
                data: {
                    statePath: 'fundRvd.data'
                },
                statusType: {
                    type: Array,
                    value: [
                        {
                            label: 'เปิดการใช้งาน',
                            value: true
                        },
                        {
                            label: 'ปิดการใช้งาน',
                            value: false
                        }
                    ]
                }
            },
            getForm: function () {
                var validate = this.validateForm('#form');
                // console.log(validate);
                if(validate == true){
                    var data = this.data;
                    data.count_emp = parseInt(this.data.count_emp);
                    data.unit_value = parseFloat(this.data.unit_value);
                    data.reward = parseFloat(this.data.reward);
                    data.property_value = parseFloat(this.data.property_value);
                    // console.log(data);
                    if (typeof data.id != 'undefined') {
                        this.dispatchAction('FUND_RVD_UPDATE', data);
                    }
                    else {
                        this.dispatchAction('FUND_RVD_INSERT', data);
                    }
                }
              
            },
            cancel: function () {
                if (typeof this.data.id != 'undefined') {
                    this.dispatchAction('FUND_RVD_SELECT', this.data.id);
                }
                else {
                    this.dispatchAction('FUND_RVD_CLEAR_DATA');
                    this.fire('close')
                }
                this.resetComponents();
            },
            resetComponents: function () {    
                var elements = Polymer.dom(this.root).querySelectorAll('#form');
                elements.map((item) => {
                    item.removeAttribute("required");
                    item.validate();
                    item.setAttribute("required", true);
                })
            },
            openEditForm: function () {
                this.editForm = false;
            }
        });
    </script>
</dom-module>